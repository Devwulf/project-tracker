{"version":3,"sources":["services/DBService.js","components/Modal.js","components/ProjectForm.js","components/SidebarNav.js","components/ScaledDrag.tsx","components/Node.js","components/WorkArea.js","components/Project.js","App.js","serviceWorker.js","index.js"],"names":["this","db","Dexie","version","stores","projects","nodes","open","catch","e","console","error","name","seedData","toArray","then","length","addProject","addNode","title","description","project","add","projectId","initialX","initialY","connectedFrom","connectedTo","node","Modal","props","state","isModalOpen","handleOpenModal","bind","handleCloseModal","openModal","setState","children","closeModal","className","onClick","icon","React","Component","ProjectForm","titleProp","descriptionProp","handleOnTitleChange","handleOnDescriptionChange","log","projectTitle","projectDescription","event","target","value","action","htmlFor","id","type","onChange","handleOnProjectCreate","handleOnProjectUpdate","SidebarNav","isNavMenuOpen","openProjectModal","openNavMenu","closeNavMenu","toggleNavMenu","DBService","refreshProjects","stack","to","map","element","i","key","noScrollX","callable","ScaledDrag","x","undefined","y","dx","startX","dy","startY","isDragging","handleDragStart","onDragStart","resetOnStart","scaleX","scaleY","persist","point","localPoint","Math","floor","handleDragMove","onDragMove","handleDragEnd","onDragEnd","resetOnEnd","width","height","captureDragArea","onMouseMove","onMouseUp","fill","dragEnd","dragMove","dragStart","defaultProps","Node","item","zoom","transformMatrix","transform","style","cursor","onMouseDown","onTouchMove","onTouchStart","onTouchEnd","onPointerUp","toggleNodeOptions","data-name","rx","stroke","selectedNodeId","strokeWidth","filter","handleOpenViewNode","handleOpenEditNode","handleOnNodeDelete","handleEdgeCtrlDragEnd","cx","cy","r","visibility","initialTransformZoom","translateX","translateY","skewX","skewY","WorkArea","draggableItems","isDirtyDB","isDirtyDOM","nodeCtrlHidden","listeners","edges","openNodeModal","nodeModalMode","nodeTitle","nodeDescription","handleOnEdgeCreated","handleOnEdgeDelete","handleOpenCreateNode","handleOnNodeCreate","handleOnNodeUpdate","toggleNodeCtrl","checkGraphCycleExists","parseInt","where","equals","forEach","array","concat","index","indexOfWhen","raised","splice","array2","edge","update","updated","clientX","changedTouches","clientY","document","elementsFromPoint","find","getAttribute","otherId","substring","other","n","indexOf","push","some","result","newArr","fromId","toId","itemId","indexTo","indexFrom","removeIf","delete","Zoom","scaleXMin","scaleXMax","scaleYMin","scaleYMax","in","stdDeviation","in2","mode","onMouseLeave","toString","changePosCallable","startDx","startDy","endDx","endDy","handleOnClick","midPointX","midPointY","isHovered","scale","reset","Array","prototype","predicate","EdgeStart","handlePosChanged","EdgeEnd","Edge","handleOnEnter","handleOnExit","d","onMouseEnter","NodeForm","data","editor","ClassicEditor","getData","NodeView","componentDidUpdate","dangerouslySetInnerHTML","__html","DOMPurify","sanitize","Project","selectedProject","topHidden","handleHideTop","handleOnProjectDelete","get","ParentSize","library","fas","App","handleAddProject","path","ParamsProvider","useParams","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","ReactDOM","render","StrictMode","getElementById","URL","process","href","origin","addEventListener","fetch","headers","response","contentType","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.fffa74f3.chunk.js","sourcesContent":["import Dexie from 'dexie';\r\n\r\nclass DBService {\r\n    // TODO: Eventually use the # hastag private class fields\r\n    constructor() {\r\n        this.db = new Dexie('ProjectTrackerDB');\r\n        // This means it creates a projects table with\r\n        // an id primary key and an indexed title column\r\n        this.db.version(1).stores({ \r\n            projects: \"++id,title\",\r\n            nodes: \"++id,projectId\"\r\n        });\r\n        this.db.open().catch(e => {\r\n            console.error(\"Opening the db '\" + this.db.name + \"' failed: \" + e);\r\n        });\r\n\r\n        this.seedData();\r\n    }\r\n\r\n    seedData() {\r\n        this.db.projects.toArray().then(projects => {\r\n            if (projects.length <= 0) {\r\n                this.addProject(\"Adventure Game\", \"Creating a new, fun adventure game!\");\r\n                this.addProject(\"Test Project\", \"A simple test project.\");\r\n            }\r\n        });\r\n\r\n        this.db.nodes.toArray().then(nodes => {\r\n            if (nodes.length <= 0) {\r\n                this.addNode(1, \"Test\", \"Description\", 150, 100, [2], []);\r\n                this.addNode(1, \"Another Test\", \"Description\", 200, 300, [3], [1]);\r\n                this.addNode(1, \"Another Another Test\", \"Description\", 300, 450, [], [2]);\r\n                this.addNode(2, \"Different Project\", \"Description\", 100, 200, [], []);\r\n                this.addNode(2, \"Another node\", \"Description\", 150, 400, [], []);\r\n            }\r\n        });\r\n    }\r\n\r\n    get projects() {\r\n        return this.db.projects;\r\n    }\r\n\r\n    addProject(title, description) {\r\n        const project = {\r\n            title, \r\n            description\r\n        };\r\n\r\n        return this.db.projects.add(project);\r\n    }\r\n\r\n    get nodes() {\r\n        return this.db.nodes;\r\n    }\r\n\r\n    addNode(projectId, name, description, initialX, initialY, connectedFrom, connectedTo) {\r\n        const node = {\r\n            projectId,\r\n            name,\r\n            description,\r\n            initialX,\r\n            initialY,\r\n            connectedFrom,\r\n            connectedTo\r\n        };\r\n\r\n        return this.db.nodes.add(node);\r\n    }\r\n}\r\n\r\nexport default new DBService();","import React from 'react';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\n\r\nexport default class Modal extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            isModalOpen: false\r\n        };\r\n\r\n        this.handleOpenModal = this.handleOpenModal.bind(this);\r\n        this.handleCloseModal = this.handleCloseModal.bind(this);\r\n    }\r\n    \r\n    componentDidMount() {\r\n        this.props.openModal(this.handleOpenModal);\r\n    }\r\n\r\n    handleOpenModal() {\r\n        this.setState({isModalOpen: true});\r\n    }\r\n\r\n    handleCloseModal() {\r\n        this.setState({isModalOpen: false});\r\n    }\r\n\r\n    render() {\r\n        const {children} = this.props;\r\n        const closeModal = this.handleCloseModal;\r\n        return(\r\n            <div className={`${this.state.isModalOpen ? 'flex' : 'hidden'} absolute-full items-center justify-center z-30`}>\r\n                <div className=\"absolute-full opacity-50 bg-gray-900 cursor-pointer\"\r\n                     onClick={this.handleCloseModal}></div>\r\n                <div className=\"p-4 sm:p-8 w-2/3 lg:w-1/2 bg-gray-100 z-40 rounded shadow-lg\">\r\n                    <div className=\"mb-4 flex items-center justify-between text-gray-800\">\r\n                        <span className=\"text-lg font-medium\">\r\n                            {this.props.title}\r\n                        </span>\r\n                        <FontAwesomeIcon className=\"text-lg sm:text-xl cursor-pointer\" \r\n                                         icon=\"times\"\r\n                                         onClick={this.handleCloseModal} />\r\n                    </div>\r\n                    <div>\r\n                        {children({ closeModal })}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}","import React from 'react';\r\n\r\nexport default class ProjectForm extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        const {title, description} = props;\r\n        this.state = {\r\n            title: title || \"\",\r\n            description: description || \"\",\r\n            titleProp: title || \"\",\r\n            descriptionProp: description || \"\"\r\n        };\r\n\r\n        this.handleOnTitleChange = this.handleOnTitleChange.bind(this);\r\n        this.handleOnDescriptionChange = this.handleOnDescriptionChange.bind(this);\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        const {title, description} = this.props;\r\n        console.log(title + \" \" + description);\r\n        if (this.state.titleProp === title &&\r\n            this.state.descriptionProp === description)\r\n            return;\r\n            \r\n        let projectTitle = \"\";\r\n        let projectDescription = \"\";\r\n        if (title)\r\n            projectTitle = title;\r\n\r\n        if (description)\r\n            projectDescription = description;\r\n\r\n        this.setState({title: projectTitle, description: projectDescription, titleProp: projectTitle, descriptionProp: projectDescription});\r\n    }\r\n\r\n    handleOnTitleChange(event) {\r\n        this.setState({title: event.target.value});\r\n    }\r\n\r\n    handleOnDescriptionChange(event) {\r\n        this.setState({description: event.target.value});\r\n    }\r\n\r\n    render() {\r\n        return(\r\n            <form className=\"text-gray-800\" action=\"\">\r\n                <label htmlFor=\"projectTitle\">\r\n                    <p className=\"mb-2\">Title</p>\r\n                    <input id=\"projectTitle\" className=\"px-2 py-1 mb-4 w-full rounded shadow-inner bg-gray-300 text-gray-700 outline-none focus:shadow-outline focus:bg-blue-100\" \r\n                        type=\"text\"\r\n                        value={this.state.title}\r\n                        onChange={this.handleOnTitleChange} />\r\n                </label>\r\n                <label htmlFor=\"projectDescription\">\r\n                    <p className=\"mb-2\">Description</p>\r\n                    <input id=\"projectTitle\" className=\"px-2 py-1 mb-4 w-full rounded shadow-inner bg-gray-300 text-gray-700 outline-none focus:shadow-outline focus:bg-blue-100\" \r\n                        type=\"text\"\r\n                        value={this.state.description}\r\n                        onChange={this.handleOnDescriptionChange} />\r\n                </label>\r\n                <div className=\"mt-4 flex flex-col justify-center sm:justify-start sm:flex-row-reverse\">\r\n                    <input className=\"px-4 py-2 mb-2 sm:mb-0 rounded-md bg-indigo-500 text-gray-100 hover:bg-indigo-400 cursor-pointer\" \r\n                        type=\"button\" \r\n                        value={`${this.props.handleOnProjectCreate ? 'Create' : 'Edit'} Project`}\r\n                        onClick={() => {\r\n                            if (this.props.handleOnProjectCreate) {\r\n                                if (this.props.handleOnProjectCreate(this.state.title, this.state.description))\r\n                                    this.props.handleCloseModal();\r\n                            } else if (this.props.handleOnProjectUpdate) {\r\n                                if (this.props.handleOnProjectUpdate(this.state.title, this.state.description))\r\n                                    this.props.handleCloseModal();\r\n                            }\r\n                        }} />\r\n                    <input className=\"px-4 py-2 sm:mr-2 rounded-md bg-gray-300 text-indigo-500 hover:bg-gray-400 cursor-pointer\" \r\n                           type=\"button\" \r\n                           value=\"Cancel\" \r\n                           onClick={this.props.handleCloseModal} />\r\n                </div>\r\n            </form>\r\n        );\r\n    }\r\n}","import React from 'react';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { Link } from 'react-router-dom';\r\nimport Scrollbar from 'react-scrollbars-custom';\r\n\r\nimport DBService from '../services/DBService';\r\nimport Modal from './Modal';\r\nimport ProjectForm from './ProjectForm';\r\n\r\nexport default class SidebarNav extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            isNavMenuOpen: false,\r\n            openProjectModal: null\r\n        };\r\n\r\n        this.openNavMenu = this.openNavMenu.bind(this);\r\n        this.closeNavMenu = this.closeNavMenu.bind(this);\r\n        this.toggleNavMenu = this.toggleNavMenu.bind(this);\r\n        this.handleOnProjectCreate = this.handleOnProjectCreate.bind(this);\r\n    }\r\n\r\n    openNavMenu() {\r\n        this.setState({isNavMenuOpen: true});\r\n    }\r\n\r\n    closeNavMenu() {\r\n        this.setState({isNavMenuOpen: false});\r\n    }\r\n\r\n    toggleNavMenu() {\r\n        if (this.state.isNavMenuOpen)\r\n            this.closeNavMenu();\r\n        else\r\n            this.openNavMenu();\r\n    }\r\n\r\n    handleOnProjectCreate(title, description) {\r\n        if (!title || !description)\r\n            return false;\r\n\r\n        DBService.addProject(title, description).then(() => {\r\n            this.props.refreshProjects();\r\n        }).catch(error => {\r\n            console.error(error.stack || error);\r\n        });\r\n\r\n        return true;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <nav className=\"nav\">\r\n                {/* \r\n                * Plan is to have a top navigation for md and below\r\n                * screen sizes, but have sidebar for lg and above\r\n                * \r\n                * Ignore animations for now\r\n                */}\r\n\r\n                { /* Top navbar */ }\r\n                <div className=\"lg:hidden flex items-center justify-between p-4 bg-gray-800\">\r\n                    { /* Logo */ }\r\n                    <div className=\"\">\r\n                        <FontAwesomeIcon className=\"mr-4 text-2xl text-indigo-500\" icon=\"project-diagram\" />\r\n                        <Link to=\"/\" className=\"text-xl text-gray-100 font-semibold\">Project Tracker</Link>\r\n                    </div>\r\n\r\n                    { /* Hamburger for sidebar items */ }\r\n                    <div className=\"block\">\r\n                        <button className=\"flex items-center py-2 px-3 text-indigo-500 rounded border border-indigo-500 hover:bg-indigo-300\"\r\n                                onClick={this.toggleNavMenu} >\r\n                            <FontAwesomeIcon icon=\"bars\" />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                { /* Nav Items */ }\r\n                <div className={`${this.state.isNavMenuOpen ? '' : 'hidden'} lg:hidden relative z-20`}>\r\n                    <div className=\"absolute w-full px-4 pb-4 bg-gray-800\">\r\n                        {\r\n                            this.props.projects.map((element, i) => (\r\n                                <Link key={i} onClick={this.closeNavMenu} to={\"/project/\" + element.id} className=\"block mb-1 px-4 py-2 rounded-md hover:bg-gray-900 focus:bg-gray-900 text-gray-100\">\r\n                                    <FontAwesomeIcon className=\"mr-4 text-lg text-gray-600\" icon=\"folder\" />\r\n                                    {element.title}\r\n                                </Link>\r\n                            ))\r\n                        }\r\n                            <div className=\"w-full mb-1 px-4 py-2 rounded-md border-gray-600 border-dashed border-2 cursor-pointer hover:bg-gray-900 focus:bg-gray-900 text-gray-500\"\r\n                                    onClick={() => {\r\n                                        this.state.openProjectModal();\r\n                                        this.closeNavMenu();\r\n                                    }}>\r\n                                <FontAwesomeIcon className=\"mr-4 text-lg text-gray-600\" icon=\"plus\" />\r\n                                <span className=\"font-medium\">Add Project</span>\r\n                            </div>\r\n                    </div>\r\n                </div>\r\n\r\n                { /* Sidebar */ }\r\n                <div className=\"hidden lg:flex\">\r\n                    <div className=\"flex-grow h-screen bg-gray-800 relative\">\r\n                        { /* Logo */ }\r\n                        <div className=\"p-4 h-16\">\r\n                            <FontAwesomeIcon className=\"mr-4 text-2xl text-indigo-500\" icon=\"project-diagram\" />\r\n                            <Link to=\"/\" className=\"text-xl text-gray-100 font-semibold\">Project Tracker</Link>\r\n                        </div>\r\n\r\n                        { /* Sidebar Items */ }\r\n                        <div className=\"p-2 fixed top-16 bottom-0 my-auto lg:w-3/12 xl:w-1/5\">\r\n                            { /* TODO: Place the dashboard item here */ }\r\n                            <Scrollbar noScrollX>\r\n                                {\r\n                                    this.props.projects.map((element, i) => (\r\n                                        <Link key={i} to={\"/project/\" + element.id} className=\"block mb-1 px-4 py-2 rounded-md hover:bg-gray-900 focus:bg-gray-900 text-gray-100\">\r\n                                            <FontAwesomeIcon className=\"mr-4 text-lg text-gray-600\" icon=\"folder\" />\r\n                                            {element.title}\r\n                                        </Link>\r\n                                    ))\r\n                                }\r\n                                \r\n                                <div className=\"w-full mb-1 px-4 py-2 rounded-md border-gray-600 border-dashed border-2 cursor-pointer hover:bg-gray-900 focus:bg-gray-900 text-gray-500\"\r\n                                        onClick={this.state.openProjectModal}>\r\n                                    <FontAwesomeIcon className=\"mr-4 text-lg text-gray-600\" icon=\"plus\" />\r\n                                    <span className=\"font-medium\">Add Project</span>\r\n                                </div>\r\n                            </Scrollbar>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Modals here */}\r\n                <Modal title=\"Create New Project\"\r\n                        openModal={callable => {\r\n                            if (!this.state.openProjectModal)\r\n                                this.setState({openProjectModal: callable});\r\n                        }}>\r\n                    {({closeModal}) => (\r\n                    <ProjectForm title=\"\"\r\n                                    description=\"\"\r\n                                    handleOnProjectCreate={this.handleOnProjectCreate}\r\n                                    handleCloseModal={closeModal} />\r\n                    )}\r\n                </Modal>\r\n            </nav>\r\n        );\r\n    }\r\n}","import React from 'react';\r\nimport { localPoint } from '@vx/event';\r\n\r\ntype MouseOrTouchEvent = React.MouseEvent | React.TouchEvent;\r\n\r\nexport type DragProps = {\r\n  /** Children render function which is passed the state of dragging and callbacks for drag start/end/move. */\r\n  children: (args: ChildrenArgs) => React.ReactNode;\r\n  /** Width of the drag container. */\r\n  width: number;\r\n  /** Height of the drag container. */\r\n  height: number;\r\n  /** Whether to render an invisible rect below children to capture the drag area as defined by width and height. */\r\n  captureDragArea?: boolean;\r\n  /** Whether to reset drag state upon the start of a new drag. */\r\n  resetOnStart?: boolean;\r\n  /** Whether to reset drag state upon the end of a drag. */\r\n  resetOnEnd?: boolean;\r\n  /** Optional callback invoked upon drag end. */\r\n  onDragEnd?: (args: HandlerArgs) => void;\r\n  /** Optional callback invoked upon drag movement. */\r\n  onDragMove?: (args: HandlerArgs) => void;\r\n  /** Optional callback invoked upon drag start. */\r\n  onDragStart?: (args: HandlerArgs) => void;\r\n  /** Optional callback invoked upon clicking. */\r\n  onClick?: (event: MouseOrTouchEvent) => void;\r\n\r\n  /** The starting value for x */\r\n  startX: number;\r\n  /** The starting value for y */\r\n  startY: number;\r\n\r\n  /** The X scaling given by the Zoom scale */\r\n  scaleX: number;\r\n  /** The X scaling given by the Zoom scale */\r\n  scaleY: number;\r\n};\r\n\r\nexport type DragState = {\r\n  x: number | undefined;\r\n  y: number | undefined;\r\n  dx: number;\r\n  dy: number;\r\n  isDragging: boolean;\r\n};\r\n\r\nexport type HandlerArgs = DragState & { event: MouseOrTouchEvent };\r\n\r\ntype ChildrenArgs = DragState & {\r\n  dragEnd: (event: MouseOrTouchEvent) => void;\r\n  dragMove: (event: MouseOrTouchEvent) => void;\r\n  dragStart: (event: MouseOrTouchEvent) => void;\r\n};\r\n\r\nexport default class ScaledDrag extends React.Component<DragProps, DragState> {\r\n  static defaultProps = {\r\n    captureDragArea: true,\r\n    resetOnStart: false,\r\n    resetOnEnd: false,\r\n  };\r\n\r\n  state = {\r\n    x: undefined,\r\n    y: undefined,\r\n    dx: this.props.startX || 0,\r\n    dy: this.props.startY || 0,\r\n    isDragging: false,\r\n  };\r\n\r\n  handleDragStart = (event: MouseOrTouchEvent) => {\r\n    const { onDragStart, resetOnStart, scaleX, scaleY } = this.props;\r\n    event.persist();\r\n    this.setState(\r\n      ({ dx, dy }) => {\r\n        const point = localPoint(event) || { x: 0, y: 0 };\r\n        return {\r\n          isDragging: true,\r\n          dx: resetOnStart ? 0 : dx,\r\n          dy: resetOnStart ? 0 : dy,\r\n          x: resetOnStart ? Math.floor(point.x / scaleX) : Math.floor(point.x / scaleX) - dx,\r\n          y: resetOnStart ? Math.floor(point.y / scaleY) : Math.floor(point.y / scaleY) - dy,\r\n        };\r\n      },\r\n      onDragStart &&\r\n        (() => {\r\n          onDragStart({ ...this.state, event });\r\n        }),\r\n    );\r\n  };\r\n\r\n  handleDragMove = (event: MouseOrTouchEvent) => {\r\n    const { onDragMove, scaleX, scaleY } = this.props;\r\n    event.persist();\r\n\r\n    this.setState(\r\n      ({ x, y, isDragging }) => {\r\n        const point = localPoint(event) || { x: 0, y: 0 };\r\n        return isDragging\r\n          ? {\r\n              isDragging: true,\r\n              dx: (Math.floor(point.x / scaleX) - (x || 0)),\r\n              dy: (Math.floor(point.y / scaleY) - (y || 0)),\r\n            }\r\n          : null;\r\n      },\r\n      onDragMove &&\r\n        (() => {\r\n          if (this.state.isDragging) onDragMove({ ...this.state, event });\r\n        }),\r\n    );\r\n  };\r\n\r\n  handleDragEnd = (event: MouseOrTouchEvent) => {\r\n    const { onDragEnd, resetOnEnd } = this.props;\r\n    event.persist();\r\n    \r\n    this.setState(state => (\r\n      { \r\n        isDragging: false,\r\n        dx: resetOnEnd ? 0 : state.dx,\r\n        dy: resetOnEnd ? 0 : state.dy\r\n      }),\r\n      onDragEnd &&\r\n        (() => {\r\n          onDragEnd({ ...this.state, event });\r\n        }),\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { x, y, dx, dy, isDragging } = this.state;\r\n    const { children, width, height, captureDragArea } = this.props;\r\n    return (\r\n      <>\r\n        {isDragging && captureDragArea && (\r\n          <rect\r\n            width={width}\r\n            height={height}\r\n            onMouseMove={this.handleDragMove}\r\n            onMouseUp={this.handleDragEnd}\r\n            fill=\"transparent\"\r\n          />\r\n        )}\r\n        {children({\r\n          x,\r\n          y,\r\n          dx,\r\n          dy,\r\n          isDragging,\r\n          dragEnd: this.handleDragEnd,\r\n          dragMove: this.handleDragMove,\r\n          dragStart: this.handleDragStart,\r\n        })}\r\n      </>\r\n    );\r\n  }\r\n}","import React from 'react';\r\nimport ScaledDrag from './ScaledDrag.tsx';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\n\r\nexport default class Node extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            x: 0,\r\n            y: 0\r\n        };\r\n    }\r\n\r\n    render() {\r\n         /*() => {\r\n                let items = [...draggableItems];\r\n                let currItem = {...items[i]};\r\n                currItem.x = dx / zoom.transformMatrix.scaleX;\r\n                currItem.y = dy / zoom.transformMatrix.scaleY;\r\n                items[i] = currItem;\r\n                setDraggableItems(items);\r\n            }*/\r\n        /* \r\n        <g key={`node-${item.id}`}\r\n            transform={`translate(${dx}, ${dy})`}\r\n            style={{cursor: isDragging ? 'move' : 'hand' }}\r\n            onMouseMove={dragMove}\r\n            onMouseDown={dragStart}\r\n            onMouseUp={dragEnd}\r\n            onTouchMove={dragMove}\r\n            onTouchStart={dragStart}\r\n            onTouchEnd={dragEnd}>\r\n            <rect className=\"node-root fill-current text-gray-600\" x={item.initialX} y={item.initialY} width=\"200\" height=\"150\" rx=\"10\" filter=\"url(#nodeShadow)\" />\r\n            <text className=\"fill-current text-gray-100 text-2xl\" x={item.initialX + 15} y={item.initialY + 30}>{item.name}</text>\r\n            <text className=\"fill-current text-gray-100 text-2xl\" x={item.initialX + 15} y={item.initialY + 60}>{`(${dx}, ${dy})`}</text>\r\n        </g>\r\n        */\r\n        \r\n        return(\r\n            <ScaledDrag width={this.props.width} \r\n                    height={this.props.height}\r\n                    startX={this.props.item.initialX}\r\n                    startY={this.props.item.initialY}\r\n                    scaleX={this.props.zoom.transformMatrix.scaleX}\r\n                    scaleY={this.props.zoom.transformMatrix.scaleY}>\r\n                {({ dragStart, dragEnd, dragMove, isDragging, dx, dy }) =>\r\n                    (false && isDragging) || (\r\n                        <g key={`node-${this.props.item.id}`}\r\n                            transform={`translate(${dx}, ${dy})`}\r\n                            style={{cursor: isDragging ? 'move' : 'pointer' }} >\r\n                            <g onMouseMove={event => {\r\n                                    this.props.handleDragMove(this.props.item.id, dx, dy);\r\n                                    dragMove(event);\r\n                                }}\r\n                                onMouseDown={event => {\r\n                                    this.props.handleDragStart(this.props.item.id);\r\n                                    dragStart(event);\r\n                                }}\r\n                                onMouseUp={event => {\r\n                                    this.props.handleDragEnd(this.props.item.id, dx, dy);\r\n                                    dragEnd(event);\r\n                                }}\r\n                                onTouchMove={event => {\r\n                                    this.props.handleDragMove(this.props.item.id, dx, dy);\r\n                                    dragMove(event);\r\n                                }}\r\n                                onTouchStart={event => {\r\n                                    this.props.handleDragStart(this.props.item.id);\r\n                                    dragStart(event);\r\n                                }}\r\n                                onTouchEnd={event => {\r\n                                    this.props.handleDragEnd(this.props.item.id, dx, dy);\r\n                                    dragEnd(event);\r\n                                }}>\r\n                                {/* NOTE: Oh wow, this has been one of my most annoying problems.\r\n                                    Basically, no other events could work properly with the events\r\n                                    above. I've tried onClick, onMouseDown and onTouchEnd, trying\r\n                                    different kinds of functions to run. But only onPointerUp worked! */}\r\n                                <g onPointerUp={() => this.props.toggleNodeOptions(this.props.item.id)}>\r\n                                    <rect data-name={`node-${this.props.item.id}`}\r\n                                            className=\"node-root fill-current text-gray-600\" \r\n                                            width=\"300\" \r\n                                            height=\"100\" \r\n                                            rx=\"7\"\r\n                                            style={{stroke: this.props.selectedNodeId === this.props.item.id ? \"#4a5568\" : \"none\", strokeWidth: 7}}\r\n                                            filter=\"url(#nodeShadow)\"\r\n                                            />\r\n                                    <foreignObject width=\"300\" \r\n                                                    height=\"100\">\r\n                                            <div className=\"p-4 flex items-center w-full h-full pointer-events-none\">\r\n                                                <div className=\"flex flex-col w-full text-gray-800\">\r\n                                                    <span className=\"text-2xl font-bold truncate select-none\">\r\n                                                        {this.props.item.name}\r\n                                                    </span>\r\n                                                    <span className=\"text-xl font-medium truncate select-none\">\r\n                                                        {`${5} subgoals`} &#x2022; {`${10} in list`}\r\n                                                    </span>\r\n                                                </div>\r\n                                            </div>\r\n                                    </foreignObject>\r\n                                </g>\r\n\r\n                                    {/* \r\n                                    <rect className=\"node-root fill-current text-gray-600\" \r\n                                            width=\"300\" \r\n                                            height=\"100\" \r\n                                            rx=\"10\"\r\n                                            style={{stroke: this.state.selectedNodeId === item.id ? \"#4a5568\" : \"none\", strokeWidth: 7}}\r\n                                            filter=\"url(#nodeShadow)\"/>\r\n                                    <text className=\"node-title fill-current text-gray-100 text-2xl font-medium\"\r\n                                            x={25} \r\n                                            y={45}>\r\n                                        {item.name}\r\n                                    </text>\r\n                                    <text className=\"node-status fill-current text-gray-300 text-xl\"\r\n                                            x={25} \r\n                                            y={75}>\r\n                                        {`${5} subgoals`} &#x2022; {`${10} in list`}\r\n                                    </text>\r\n                                    */}\r\n\r\n                                {/*\r\n                                <text className=\"fill-current text-gray-100 text-2xl\" x={15} y={60}>{`(${dx}, ${dy})`}</text>\r\n                                <text className=\"fill-current text-gray-100 text-2xl\" x={15} y={90}>{`(${item.initialX}, ${item.initialY})`}</text>\r\n                                */}\r\n                            </g>\r\n\r\n                            {(this.props.selectedNodeId === this.props.item.id &&\r\n                                <>\r\n                                    <g onClick={() => this.props.handleOpenViewNode(this.props.item.name, this.props.item.description)}>\r\n                                        <rect className=\"fill-current text-gray-500\"\r\n                                            x=\"23\"\r\n                                            y=\"-90\"\r\n                                            width=\"74\"\r\n                                            height=\"74\"\r\n                                            rx=\"10\"\r\n                                            filter=\"url(#nodeShadow)\"/>\r\n                                        <foreignObject x=\"23\"\r\n                                                    y=\"-90\"\r\n                                                    width=\"74\" \r\n                                                    height=\"74\" \r\n                                                    className=\"text-4xl text-gray-800 pointer-events-none\">\r\n                                            <div className=\"flex items-center justify-center w-full h-full\">      \r\n                                                <FontAwesomeIcon icon=\"eye\" />\r\n                                            </div>\r\n                                        </foreignObject>\r\n                                    </g>\r\n                                    <g onClick={() => this.props.handleOpenEditNode(this.props.item.name, this.props.item.description)}>\r\n                                        <rect className=\"fill-current text-gray-500\"\r\n                                            x=\"113\"\r\n                                            y=\"-90\"\r\n                                            width=\"74\"\r\n                                            height=\"74\"\r\n                                            rx=\"10\"\r\n                                            filter=\"url(#nodeShadow)\"/>\r\n                                        <foreignObject x=\"113\"\r\n                                                    y=\"-90\"\r\n                                                    width=\"74\" \r\n                                                    height=\"74\" \r\n                                                    className=\"text-4xl text-gray-800 pointer-events-none\">\r\n                                            <div className=\"flex items-center justify-center w-full h-full\">      \r\n                                                <FontAwesomeIcon icon=\"pencil-alt\" />\r\n                                            </div>\r\n                                        </foreignObject>\r\n                                    </g>\r\n                                    <g onClick={() => this.props.handleOnNodeDelete(this.props.item.id)}>\r\n                                        <rect className=\"fill-current text-gray-500\"\r\n                                            x=\"203\"\r\n                                            y=\"-90\"\r\n                                            width=\"74\"\r\n                                            height=\"74\"\r\n                                            rx=\"10\"\r\n                                            filter=\"url(#nodeShadow)\"/>\r\n                                        <foreignObject x=\"203\"\r\n                                                    y=\"-90\"\r\n                                                    width=\"74\" \r\n                                                    height=\"74\"  \r\n                                                    className=\"text-4xl text-gray-800 pointer-events-none\">\r\n                                            <div className=\"flex items-center justify-center w-full h-full\">      \r\n                                                <FontAwesomeIcon icon=\"trash-alt\" />\r\n                                            </div>\r\n                                        </foreignObject>\r\n                                    </g>\r\n                                </>\r\n                            )}\r\n                            <ScaledDrag key={`edge-${this.props.item.id}`}\r\n                                        width={this.props.width}\r\n                                        height={this.props.height}\r\n                                        scaleX={this.props.zoom.transformMatrix.scaleX}\r\n                                        scaleY={this.props.zoom.transformMatrix.scaleY}\r\n                                        onDragStart={() => this.props.handleDragStart(this.props.item.id)}\r\n                                        onDragEnd={state => this.props.handleEdgeCtrlDragEnd(state.event, this.props.item)}\r\n                                        resetOnStart={true}\r\n                                        resetOnEnd={true}>\r\n                                {({ dragStart, dragEnd, dragMove, isDragging, dx, dy }) => \r\n                                    (false && isDragging) || (\r\n                                        <g transform={`translate(${dx}, ${dy})`}\r\n                                            className=\"z-30\"\r\n                                            onMouseMove={dragMove}\r\n                                            onMouseDown={dragStart}\r\n                                            onMouseUp={dragEnd}\r\n                                            onTouchMove={dragMove}\r\n                                            onTouchStart={dragStart}\r\n                                            onTouchEnd={dragEnd}>\r\n                                            <circle cx=\"300\"\r\n                                                    cy=\"50\"\r\n                                                    r=\"20\"\r\n                                                    style={{visibility: \"visible\"}}\r\n                                                    className=\"fill-current text-gray-400\"/>\r\n                                            <circle cx=\"300\"\r\n                                                    cy=\"50\"\r\n                                                    r=\"20\"\r\n                                                    stroke=\"#2d3748\"\r\n                                                    strokeWidth=\"5\"\r\n                                                    fill=\"none\"\r\n                                                    className=\"pointer-events-none\"/>\r\n                                            <foreignObject x=\"280\"\r\n                                                        y=\"30\"\r\n                                                        width=\"40\" \r\n                                                        height=\"40\" \r\n                                                        className=\"text-2xl text-gray-800 pointer-events-none\">\r\n                                                <div className=\"flex items-center justify-center w-full h-full\">      \r\n                                                    <FontAwesomeIcon icon=\"plus\" />\r\n                                                </div>\r\n                                            </foreignObject>\r\n                                        </g>\r\n                                    )\r\n                                }\r\n                            </ScaledDrag>\r\n                        </g>\r\n                    )\r\n                }\r\n            </ScaledDrag>\r\n        );\r\n    }\r\n}\r\n\r\n","import React, { Children } from 'react';\r\nimport { raise } from '@vx/drag';\r\nimport { Zoom } from '@vx/zoom';\r\nimport { localPoint } from '@vx/event';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport CKEditor from '@ckeditor/ckeditor5-react';\r\nimport ClassicEditor from '@ckeditor/ckeditor5-build-classic';\r\nimport DOMPurify from 'dompurify';\r\n\r\nimport '../assets/App.css';\r\nimport '../assets/content-styles.css';\r\n\r\nimport DBService from '../services/DBService';\r\nimport Node from './Node';\r\nimport Modal from './Modal';\r\n\r\nconst initialTransformZoom = {\r\n    scaleX: 1/2,\r\n    scaleY: 1/2,\r\n    translateX: 100,\r\n    translateY: 100,\r\n    skewX: 0,\r\n    skewY: 0,\r\n};\r\n\r\nexport default class WorkArea extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            projectId: 0,\r\n            draggableItems: [],\r\n            isDirtyDB: false,\r\n            isDirtyDOM: false,\r\n            nodeCtrlHidden: true,\r\n            selectedNodeId: 0,\r\n            listeners: {},\r\n            edges: {},\r\n            openNodeModal: null,\r\n            nodeModalMode: 0, // 0 for viewing node, 1 for creating node, 2 for editing\r\n            nodeTitle: \"\", // used for editing\r\n            nodeDescription: \"\"\r\n        };\r\n\r\n        this.handleDragStart = this.handleDragStart.bind(this);\r\n        this.handleDragMove = this.handleDragMove.bind(this);\r\n        this.handleDragEnd = this.handleDragEnd.bind(this);\r\n        this.handleEdgeCtrlDragEnd = this.handleEdgeCtrlDragEnd.bind(this);\r\n\r\n        this.handleOnEdgeCreated = this.handleOnEdgeCreated.bind(this);\r\n        this.handleOnEdgeDelete = this.handleOnEdgeDelete.bind(this);\r\n\r\n        this.handleOpenViewNode = this.handleOpenViewNode.bind(this);\r\n        this.handleOpenCreateNode = this.handleOpenCreateNode.bind(this);\r\n        this.handleOpenEditNode = this.handleOpenEditNode.bind(this);\r\n\r\n        this.handleOnNodeCreate = this.handleOnNodeCreate.bind(this);\r\n        this.handleOnNodeUpdate = this.handleOnNodeUpdate.bind(this);\r\n        this.handleOnNodeDelete = this.handleOnNodeDelete.bind(this);\r\n\r\n        this.toggleNodeCtrl = this.toggleNodeCtrl.bind(this);\r\n        this.toggleNodeOptions = this.toggleNodeOptions.bind(this);\r\n        this.checkGraphCycleExists = this.checkGraphCycleExists.bind(this);\r\n    }\r\n    \r\n    componentDidUpdate() {\r\n        const id = parseInt(this.props.projectId);\r\n        if (this.state.projectId !== id || this.state.isDirtyDB) {\r\n            DBService.nodes.where('projectId').equals(id).toArray().then(nodes => {\r\n                this.setState({\r\n                    projectId: id,\r\n                    draggableItems: nodes,\r\n                    isDirtyDB: false\r\n                });\r\n            }).catch(error => {\r\n                console.error(error.stack || error);\r\n            });\r\n        }\r\n\r\n        if (this.state.isDirtyDOM) {\r\n            // Initialize the edge positions here\r\n            this.state.draggableItems.forEach(item => {\r\n                this.handleDragMove(item.id, item.initialX, item.initialY);\r\n            });\r\n\r\n            this.setState({isDirtyDOM: false});\r\n        }\r\n    }\r\n\r\n    handleDragStart(id) {\r\n        // TODO: In chrome, this somehow prevents a child onclick to run\r\n        const array = [].concat(this.state.draggableItems);\r\n        const index = array.indexOfWhen(item => item.id === id);\r\n        const raised = array.splice(index, 1)[0];\r\n        const array2 = array.concat(raised);\r\n        \r\n        this.setState({ draggableItems: array2 });\r\n    }\r\n\r\n    handleDragMove(id, dx, dy) {\r\n        // How will we pass this to the edge itself?\r\n        let edges = this.state.edges[id];\r\n        if (edges && edges.length > 0) {\r\n            edges.forEach(edge => {\r\n                edge.callable(dx, dy);\r\n            });\r\n        }\r\n    }\r\n\r\n    handleDragEnd(id, dx, dy) {\r\n        \r\n        // Save changes immediately to db\r\n        DBService.nodes.update(id, {initialX: dx, initialY: dy}).then(updated => {\r\n            \r\n            this.setState({isDirtyDB: true});\r\n            // Show a toast or an out of the way notif for changes saved\r\n        });\r\n    }\r\n\r\n    handleEdgeCtrlDragEnd(event, item) {\r\n        // TODO: Check if clientX and clientY from events work\r\n        let x = Math.floor(event.clientX || event.changedTouches[0].clientX);\r\n        let y = Math.floor(event.clientY || event.changedTouches[0].clientY);\r\n\r\n        let elements = document.elementsFromPoint(x, y);\r\n        let element = elements.find(e => e.getAttribute('data-name'));\r\n        if (!element)\r\n            return;\r\n\r\n        let name = element.getAttribute('data-name');\r\n        if (name === undefined || name === null)\r\n            return null;\r\n\r\n        if (name !== `node-${item.id}`) {\r\n            // register this new id to the connected array of this item\r\n            let nodes = this.state.draggableItems;\r\n\r\n            let otherId = parseInt(name.substring(5));\r\n            let other = nodes.find(n => n.id === otherId);\r\n            let connectedFrom = other.connectedFrom;\r\n\r\n            // get current connected array from db\r\n            // Note: A get here from the db shouldn't really happen, let the\r\n            // update lifecycle handle the getting from database, this is supposed\r\n            // to trust the nodes that the state currently has\r\n            // TODO: Actually, ignore the above note. If we want this app to be\r\n            // usable by concurrent users, we'll definitely need to update from the\r\n            // db with every action that could change the db that we do. But then,\r\n            // we'll need to first use a different db instead of indexed db\r\n            let node = item; //nodes.find(n => n.id === item.id); // Why are we searching for the item that's passed as an arg?!\r\n            let connectedTo = node.connectedTo;\r\n\r\n            let index = connectedTo.indexOf(other.id);\r\n\r\n            if (index < 0) {\r\n                // Check if adding this node creates a cycle in the graph\r\n                if (this.checkGraphCycleExists(other.connectedTo, node.id))\r\n                    return;\r\n\r\n                connectedTo.push(other.id); // add id if not found\r\n                connectedFrom.push(node.id);\r\n            }\r\n\r\n            DBService.nodes.update(node.id, {connectedTo: connectedTo}).then(updated => {\r\n                return DBService.nodes.update(other.id, {connectedFrom: connectedFrom});\r\n            }).then(updated => {\r\n                this.setState({isDirtyDB: true});\r\n            });\r\n        }\r\n    }\r\n\r\n    // Starting arr is the connectedTo arr of the node\r\n    // the user wants to connect to\r\n    // The id is the id of the node the user is\r\n    // connecting from\r\n    checkGraphCycleExists(connectedTo, id) {\r\n        if (connectedTo.some(e => e === id))\r\n            return true;\r\n\r\n        var result = false;\r\n\r\n        for (var i = 0; i < connectedTo.length; i++) {\r\n            let e = connectedTo[i];\r\n            // Get the connectedTo array of the node with e as the id\r\n            let newArr = this.state.draggableItems.find(n => n.id === e).connectedTo;\r\n            result = this.checkGraphCycleExists(newArr, id);\r\n            if (result)\r\n                break;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    handleOnEdgeCreated(fromId, toId, callable) {\r\n        let edges = this.state.edges;\r\n        if(!edges[fromId])\r\n            edges[fromId] = [];\r\n\r\n        let edge = {\r\n            to: toId,\r\n            callable: callable\r\n        };\r\n        edges[fromId].push(edge);\r\n        this.setState({edges: edges, isDirtyDOM: true});\r\n    }\r\n\r\n    handleOnEdgeDelete(itemId, otherId) {\r\n        let connectedTo = this.state.draggableItems.find(n => n.id === itemId).connectedTo;\r\n        let connectedFrom = this.state.draggableItems.find(n => n.id === otherId).connectedFrom;\r\n        let indexTo = connectedTo.indexOf(otherId);\r\n        let indexFrom = connectedFrom.indexOf(itemId);\r\n        if (indexTo < 0 || indexFrom < 0)\r\n            return;\r\n\r\n        connectedTo.splice(indexTo, 1); // remove if in array already\r\n        connectedFrom.splice(indexFrom, 1);\r\n\r\n        // Also remove the callables from the edges array\r\n        let edges = this.state.edges;\r\n        edges[itemId].removeIf(edge => edge.to === otherId);\r\n        edges[otherId].removeIf(edge => edge.to === itemId);\r\n\r\n        this.setState({edges: edges});\r\n\r\n        DBService.nodes.update(itemId, {connectedTo: connectedTo}).then(updated => {\r\n            return DBService.nodes.update(otherId, {connectedFrom: connectedFrom});\r\n        }).then(updated => {\r\n            this.setState({isDirtyDB: true});\r\n        })\r\n    }\r\n\r\n    handleOnNodeCreate(dx, dy, title, description) {\r\n        if (!title || !description)\r\n            return false;\r\n\r\n        const projectId = this.state.projectId;\r\n\r\n        DBService.addNode(projectId, title, description, dx, dy, [], []).then(() => {\r\n            this.setState({isDirtyDB: true});\r\n        }).catch(error => {\r\n            console.error(error.stack || error);\r\n        });\r\n\r\n        return true;\r\n    }\r\n\r\n    handleOnNodeUpdate(itemId, title, description) {\r\n        if (!title || !description)\r\n            return false;\r\n\r\n        DBService.nodes.update(itemId, {name: title, description: description}).then(() => {\r\n            this.setState({isDirtyDB: true});\r\n        });\r\n\r\n        return true;\r\n    }\r\n\r\n    handleOnNodeDelete(id) {\r\n        // TODO: Remove all the nodes connected to this\r\n        let node = this.state.draggableItems.find(item => item.id === id);\r\n        // TODO: This is very inefficient, better to track all\r\n        // the changes first then save changes afterwards\r\n        node.connectedTo.forEach(e => {\r\n            this.handleOnEdgeDelete(node.id, e);\r\n        });\r\n\r\n        node.connectedFrom.forEach(e => {\r\n            this.handleOnEdgeDelete(e, node.id);\r\n        });\r\n\r\n        DBService.nodes.delete(id).then(() => {\r\n            this.setState({isDirtyDB: true});\r\n        });\r\n    }\r\n\r\n    handleOpenViewNode(title, description) {\r\n        this.state.openNodeModal();\r\n        this.setState({nodeModalMode: 0, nodeTitle: title, nodeDescription: description});\r\n    }\r\n\r\n    handleOpenCreateNode() {\r\n        this.state.openNodeModal();\r\n        this.setState({nodeModalMode: 1});\r\n    }\r\n\r\n    handleOpenEditNode(title, description) {\r\n        this.state.openNodeModal();\r\n        this.setState({nodeModalMode: 2, nodeTitle: title, nodeDescription: description});\r\n    }\r\n\r\n    toggleNodeCtrl() {\r\n        this.setState(state => ({nodeCtrlHidden: !state.nodeCtrlHidden}));\r\n    }\r\n\r\n    toggleNodeOptions(id) {\r\n        if (this.state.selectedNodeId === id)\r\n            this.setState({selectedNodeId: 0});\r\n        else\r\n            this.setState({selectedNodeId: id});\r\n    }\r\n\r\n    render() {\r\n        let width = this.props.width;\r\n        let height = this.props.height;\r\n        return(\r\n            <>\r\n                <Zoom width={width} \r\n                    height={height}\r\n                    scaleXMin={1/4}\r\n                    scaleXMax={2}\r\n                    scaleYMin={1/4}\r\n                    scaleYMax={2}\r\n                    transformMatrix={initialTransformZoom}>\r\n                    {zoom => (\r\n                        <div className=\"relative bg-gray-300\">\r\n                            <svg width={width} height={height} style={{cursor: zoom.isDragging ? 'grabbing' : 'grab' }}>\r\n                                <defs>\r\n                                    <filter id=\"nodeShadow\" x=\"-50%\" y=\"-50%\" width=\"160%\" height=\"160%\">\r\n                                        <feOffset result=\"offOut\" in=\"SourceGraphic\" dy=\"4\" />\r\n                                        <feGaussianBlur result=\"blurOut\" in=\"offOut\" stdDeviation=\"4\" />\r\n                                        <feBlend in=\"SourceGraphic\" in2=\"blurOut\" mode=\"normal\" />\r\n                                    </filter>\r\n                                </defs>\r\n                                <rect width={width}\r\n                                      height={height}\r\n                                      fill=\"transparent\"\r\n                                      onTouchStart={zoom.dragStart}\r\n                                      onTouchMove={zoom.dragMove}\r\n                                      onTouchEnd={() => {\r\n                                          this.toggleNodeOptions(0);\r\n                                          zoom.dragEnd();\r\n                                      }}\r\n                                      onMouseDown={zoom.dragStart}\r\n                                      onMouseMove={zoom.dragMove}\r\n                                      onMouseUp={() => {\r\n                                          this.toggleNodeOptions(0);\r\n                                          zoom.dragEnd();\r\n                                      }}\r\n                                      onMouseLeave={() => {\r\n                                          if (zoom.isDragging) zoom.dragEnd();\r\n                                      }} />\r\n                                \r\n                                <g name=\"node-root\"\r\n                                   transform={zoom.toString()}>\r\n                                    {this.state.draggableItems.map((item, i) => (\r\n                                        <g key={`${item.id}`} >\r\n                                            {item.connectedTo.map(id => (\r\n                                                <EdgeStart key={`edge-${item.id}-${id}`} \r\n                                                           changePosCallable={callable => {\r\n                                                               this.handleOnEdgeCreated(item.id, id, callable); \r\n                                                           }}>\r\n                                                    {({startDx, startDy}) => (\r\n                                                        <EdgeEnd changePosCallable={callable => {\r\n                                                            this.handleOnEdgeCreated(id, item.id, callable); \r\n                                                        }}>\r\n                                                            {({endDx, endDy}) => (\r\n                                                                <Edge startDx={startDx}\r\n                                                                      startDy={startDy}\r\n                                                                      endDx={endDx}\r\n                                                                      endDy={endDy}\r\n                                                                      handleOnClick={() => this.handleOnEdgeDelete(item.id, id)}>\r\n                                                                          \r\n                                                                    {({midPointX, midPointY, isHovered}) => (\r\n                                                                        <foreignObject visibility={isHovered ? 'visible' : 'hidden'}\r\n                                                                                       x={midPointX - 15}\r\n                                                                                       y={midPointY - 10}\r\n                                                                                       width=\"30\"\r\n                                                                                       height=\"20\"\r\n                                                                                       className=\"pointer-events-none\">\r\n                                                                            <div className=\"w-full h-full flex items-center justify-center bg-gray-800\">\r\n                                                                                <FontAwesomeIcon className=\"text-gray-300\" icon=\"times\" />\r\n                                                                            </div>\r\n                                                                        </foreignObject>\r\n                                                                    )}\r\n                                                                </Edge>\r\n                                                            )}\r\n                                                        </EdgeEnd>\r\n                                                    )}\r\n                                                </EdgeStart>\r\n                                            ))}\r\n\r\n                                            <Node item={item}\r\n                                                width={width}\r\n                                                height={height}\r\n                                                zoom={zoom}\r\n                                                selectedNodeId={this.state.selectedNodeId}\r\n                                                handleDragStart={this.handleDragStart}\r\n                                                handleDragMove={this.handleDragMove}\r\n                                                handleDragEnd={this.handleDragEnd}\r\n                                                handleEdgeCtrlDragEnd={this.handleEdgeCtrlDragEnd}\r\n                                                handleOnNodeDelete={this.handleOnNodeDelete}\r\n                                                handleOpenViewNode={this.handleOpenViewNode}\r\n                                                handleOpenEditNode={this.handleOpenEditNode}\r\n                                                toggleNodeOptions={this.toggleNodeOptions}/>\r\n                                        </g>\r\n                                    ))}\r\n                                </g>\r\n                            </svg>\r\n                            <div className=\"pin-bot-right absolute pb-4 pr-4 sm:pb-6 sm:pr-6 flex flex-col items-end\">\r\n                                <button className=\"px-2 lg:px-3 py-1 mb-1 rounded text-sm lg:text-xl bg-gray-400 hover:bg-gray-900 text-gray-900 hover:text-gray-400\"\r\n                                        onClick={() => zoom.scale({scaleX: 1.2, scaleY: 1.2})}>\r\n                                    <FontAwesomeIcon icon=\"plus\" />\r\n                                </button>\r\n                                <button className=\"px-2 lg:px-3 py-1 mb-4 rounded text-sm lg:text-xl bg-gray-400 hover:bg-gray-900 text-gray-900 hover:text-gray-400\"\r\n                                        onClick={() => zoom.scale({scaleX: 0.8, scaleY: 0.8})}>\r\n                                    <FontAwesomeIcon icon=\"minus\" />\r\n                                </button>\r\n                                <button className=\"px-2 py-1 rounded text-xs lg:text-base select-none bg-gray-400 hover:bg-gray-900 text-gray-900 hover:text-gray-400\" onClick={zoom.reset}>\r\n                                    Reset\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"pin-bot-left absolute pb-4 pl-4 sm:pb-6 sm:pl-6 flex flex-row items-center\">\r\n                                <button className=\"px-4 py-2 sm:px-6 sm:py-4 z-10 rounded-full shadow-md text-2xl bg-gray-700 hover:bg-gray-900 text-gray-300 hover:text-gray-100\" onClick={this.toggleNodeCtrl}>\r\n                                    <FontAwesomeIcon className=\"shadow-inner\" icon=\"plus\" />\r\n                                </button>\r\n                                <div className={`${this.state.nodeCtrlHidden ? 'hidden' : ''} -ml-8 pl-10 pr-2 py-2 sm:-ml-8 sm:pl-12 sm:pr-4 sm:py-2 rounded-r-lg shadow-md bg-gray-100`}>\r\n                                    <button className=\"px-3 py-1 sm:px-5 sm:py-3 rounded-lg shadow font-semibold bg-gray-400\"\r\n                                            onClick={this.handleOpenCreateNode}>\r\n                                        Node\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </Zoom>\r\n                {/* Modals here */}\r\n                <Modal title={`${this.state.nodeModalMode === 0 ? 'View' : \r\n                                this.state.nodeModalMode === 1 ? 'Create New' : 'Edit'} Node`}\r\n                       openModal={callable => {\r\n                            if (!this.state.openNodeModal)\r\n                                this.setState({openNodeModal: callable});\r\n                        }}>\r\n                    {({closeModal}) => (\r\n                        (this.state.nodeModalMode === 0 &&\r\n                            <NodeView title={this.state.nodeTitle}\r\n                                        description={this.state.nodeDescription}\r\n                                        handleCloseModal={closeModal} />\r\n                        ) ||\r\n                        (this.state.nodeModalMode === 1 &&\r\n                            <NodeForm title=\"\"\r\n                                        description=\"\"\r\n                                        handleOnNodeCreate={this.handleOnNodeCreate}\r\n                                        handleCloseModal={closeModal} />\r\n                        ) ||\r\n                        (this.state.nodeModalMode === 2 &&\r\n                            <NodeForm itemId={this.state.selectedNodeId}\r\n                                        title={this.state.nodeTitle}\r\n                                        description={this.state.nodeDescription}\r\n                                        handleOnNodeUpdate={this.handleOnNodeUpdate}\r\n                                        handleCloseModal={closeModal} />\r\n                        )\r\n                    )}\r\n                </Modal>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nArray.prototype.removeIf = function(predicate) {\r\n    let i = this.length;\r\n    while (i--) {\r\n        if (predicate(this[i]))\r\n            this.splice(i, 1);\r\n    }\r\n}\r\n\r\nArray.prototype.indexOfWhen = function(predicate) {\r\n    let i = 0;\r\n    while (i < this.length) {\r\n        if (predicate(this[i]))\r\n            return i;\r\n        i++;\r\n    }\r\n}\r\n\r\nclass EdgeStart extends React.Component {\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {\r\n            startDx: 0,\r\n            startDy: 0\r\n        };\r\n        \r\n        this.handlePosChanged = this.handlePosChanged.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.changePosCallable(this.handlePosChanged);\r\n    }\r\n\r\n    handlePosChanged(dx, dy) {\r\n        this.setState({startDx: dx, startDy: dy});\r\n    }\r\n\r\n    render() {\r\n        const {startDx, startDy} = this.state;\r\n        const {children} = this.props;\r\n        return (\r\n            <>\r\n            {children({ startDx, startDy })}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nclass EdgeEnd extends React.Component {\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {\r\n            endDx: 0,\r\n            endDy: 0\r\n        };\r\n\r\n        this.handlePosChanged = this.handlePosChanged.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.changePosCallable(this.handlePosChanged);\r\n    }\r\n\r\n    handlePosChanged(dx, dy) {\r\n        this.setState({endDx: dx, endDy: dy});\r\n    }\r\n\r\n    render() {\r\n        const {endDx, endDy} = this.state;\r\n        const {children} = this.props;\r\n        return (\r\n            <>\r\n            {children({ endDx, endDy })}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nclass Edge extends React.Component {\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {\r\n            isHovered: false\r\n        };\r\n\r\n        this.handleOnEnter = this.handleOnEnter.bind(this);\r\n        this.handleOnExit = this.handleOnExit.bind(this);\r\n    }\r\n\r\n    handleOnEnter() {\r\n        this.setState({isHovered: true});\r\n    }\r\n\r\n    handleOnExit() {\r\n        this.setState({isHovered: false});\r\n    }\r\n\r\n    render() {\r\n        let midPointX = ((this.props.endDx - this.props.startDx - 300) / 2) + (this.props.startDx + 300);\r\n        let midPointY = ((this.props.endDy + 50 - this.props.startDy - 50) / 2) + (this.props.startDy + 50);\r\n\r\n        const {isHovered} = this.state;\r\n        const {children} = this.props;\r\n        return(\r\n            <>\r\n                <path d={`M${this.props.startDx + 300} ${this.props.startDy + 50} Q${this.props.startDx + 350} ${this.props.startDy + 50} ${midPointX} ${midPointY} Q${this.props.endDx - 50} ${this.props.endDy + 50} ${this.props.endDx} ${this.props.endDy + 50}`} \r\n                    className=\"stroke-current text-gray-800 pointer-events-none\"\r\n                    strokeWidth=\"5\" \r\n                    fill=\"none\" />\r\n                <path d={`M${this.props.startDx + 300} ${this.props.startDy + 50} Q${this.props.startDx + 350} ${this.props.startDy + 50} ${midPointX} ${midPointY} Q${this.props.endDx - 50} ${this.props.endDy + 50} ${this.props.endDx} ${this.props.endDy + 50}`} \r\n                    stroke=\"transparent\"\r\n                    strokeWidth=\"50\" \r\n                    fill=\"none\" \r\n                    onMouseEnter={this.handleOnEnter}\r\n                    onMouseLeave={this.handleOnExit}\r\n                    onMouseUp={this.props.handleOnClick}\r\n                    onTouchEnd={this.props.handleOnClick} />\r\n                {children({midPointX, midPointY, isHovered})} \r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nclass NodeForm extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        const {title, description} = props;\r\n        this.state = {\r\n            title: title || \"\",\r\n            description: description || \"\",\r\n            titleProp: title || \"\",\r\n            descriptionProp: description || \"\"\r\n        };\r\n\r\n        this.handleOnTitleChange = this.handleOnTitleChange.bind(this);\r\n        this.handleOnDescriptionChange = this.handleOnDescriptionChange.bind(this);\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        const {title, description} = this.props;\r\n        if (this.state.titleProp === title &&\r\n            this.state.descriptionProp === description)\r\n            return;\r\n            \r\n        let nodeTitle = \"\";\r\n        let nodeDescription = \"\";\r\n        if (title)\r\n            nodeTitle = title;\r\n\r\n        if (description)\r\n            nodeDescription = description;\r\n\r\n        this.setState({title: nodeTitle, description: nodeDescription, titleProp: nodeTitle, descriptionProp: nodeDescription});\r\n    }\r\n\r\n    handleOnTitleChange(event) {\r\n        this.setState({title: event.target.value});\r\n    }\r\n\r\n    handleOnDescriptionChange(data) {\r\n        this.setState({description: data});\r\n    }\r\n\r\n    render() {\r\n        return(\r\n            <form className=\"text-gray-800\" action=\"\">\r\n                <label htmlFor=\"nodeTitle\">\r\n                    <p className=\"mb-2\">Title</p>\r\n                    <input id=\"nodeTitle\" className=\"px-2 py-1 mb-4 w-full rounded shadow-inner bg-gray-300 text-gray-700 outline-none focus:shadow-outline focus:bg-blue-100\" \r\n                        type=\"text\"\r\n                        value={this.state.title}\r\n                        onChange={this.handleOnTitleChange} />\r\n                </label>\r\n                <label htmlFor=\"nodeDescription\">\r\n                    <p className=\"mb-2\">Description</p>\r\n                    {/* Encode the data!!! And properly show the data in NodeView */}\r\n                    <CKEditor editor={ClassicEditor}\r\n                              data={this.state.description} \r\n                              onChange={(event, editor) => {\r\n                                  this.handleOnDescriptionChange(editor.getData());\r\n                              }}/>\r\n                </label>\r\n                <div className=\"mt-4 flex flex-col justify-center sm:justify-start sm:flex-row-reverse\">\r\n                    <input className=\"px-4 py-2 mb-2 sm:mb-0 rounded-md bg-indigo-500 text-gray-100 hover:bg-indigo-400 cursor-pointer\" \r\n                        type=\"button\" \r\n                        value={`${this.props.handleOnNodeCreate ? 'Create' : 'Edit'} Node`}\r\n                        onClick={() => {\r\n                            if (this.props.handleOnNodeCreate) {\r\n                                if (this.props.handleOnNodeCreate(0, 0, this.state.title, this.state.description))\r\n                                    this.props.handleCloseModal();\r\n                            } else if (this.props.handleOnNodeUpdate) {\r\n                                if (this.props.handleOnNodeUpdate(this.props.itemId, this.state.title, this.state.description))\r\n                                    this.props.handleCloseModal();\r\n                            }\r\n                        }} />\r\n                    <input className=\"px-4 py-2 sm:mr-2 rounded-md bg-gray-300 text-indigo-500 hover:bg-gray-400 cursor-pointer\" \r\n                           type=\"button\" \r\n                           value=\"Cancel\" \r\n                           onClick={this.props.handleCloseModal} />\r\n                </div>\r\n            </form>\r\n        );\r\n    }\r\n}\r\n\r\nclass NodeView extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            title: \"\",\r\n            description: \"\"\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.componentDidUpdate();\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        const {title, description} = this.props;\r\n        if (this.state.title === title &&\r\n            this.state.description === description)\r\n            return;\r\n            \r\n        let nodeTitle = \"\";\r\n        let nodeDescription = \"\";\r\n        if (title)\r\n            nodeTitle = title;\r\n\r\n        if (description)\r\n            nodeDescription = description;\r\n\r\n        this.setState({title: nodeTitle, description: nodeDescription});\r\n    }\r\n\r\n    render() {\r\n        return(\r\n            <div className=\"text-gray-800\">\r\n                <p className=\"mb-2 text-xl font-bold\">{this.props.title}</p>\r\n                <hr className=\"mb-4\" />\r\n                <div className=\"ck-content\" dangerouslySetInnerHTML={{__html: DOMPurify.sanitize(this.props.description)}}></div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nclass NodeChecklist extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            list: []\r\n        }\r\n    }\r\n}","import React from 'react';\r\nimport '../assets/App.css';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { ParentSize } from '@vx/responsive';\r\n\r\nimport DBService from '../services/DBService.js';\r\nimport WorkArea from './WorkArea.js';\r\nimport Modal from './Modal';\r\nimport ProjectForm from './ProjectForm';\r\n\r\nexport default class Project extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            selectedProject:  { id: 0, title: \"\", description: \"\" },\r\n            topHidden: false,\r\n            openProjectModal: null\r\n        };\r\n\r\n        this.handleHideTop = this.handleHideTop.bind(this);\r\n        this.handleOnProjectUpdate = this.handleOnProjectUpdate.bind(this);\r\n        this.handleOnProjectDelete = this.handleOnProjectDelete.bind(this);\r\n    }\r\n\r\n    // NOTE: Never ever use this.setState inside a componentDidUpdate()\r\n    // unless you can check if the update is necessary or not\r\n    componentDidUpdate() {\r\n        const id = parseInt(this.props.projectId);\r\n        if (this.state.selectedProject.id !== id) {\r\n            DBService.projects.get(id, project => {\r\n                this.setState({selectedProject: project});\r\n            }).catch(error => {\r\n                console.error(error.stack || error);\r\n            });\r\n        }\r\n    }\r\n\r\n    handleHideTop() {\r\n        this.setState(state => ({\r\n            topHidden: !state.topHidden\r\n        }));\r\n    }\r\n\r\n    handleOnProjectUpdate(title, description) {\r\n        if (!title || !description)\r\n            return false;\r\n\r\n        DBService.projects.update(this.state.selectedProject.id, {title: title, description: description}).then(() => {\r\n            this.props.refreshProjects();\r\n        }).catch(error => {\r\n            console.error(error.stack || error);\r\n        });\r\n\r\n        return true;\r\n    }\r\n\r\n    handleOnProjectDelete() {\r\n        DBService.projects.delete(this.state.selectedProject.id).then(() => {\r\n            this.props.refreshProjects();\r\n        }).catch(error => {\r\n            console.error(error.stack || error);\r\n        });\r\n    }\r\n\r\n    render() {\r\n        if (this.state.selectedProject)\r\n            return(\r\n                <div className=\"main\">\r\n                    <div className=\"relative\">\r\n                        <div className=\"absolute w-full z-10\">\r\n                            <div  className={`${this.state.topHidden ? \"hidden\" : \"flex\"}  px-4 py-2 sm:p-6 items-center justify-between shadow bg-gray-100`}>\r\n                                <div className=\"\">\r\n                                    <h1 className=\"text-xl font-bold\">{this.state.selectedProject.title}</h1>\r\n                                    <span className=\"text-gray-700\">{this.state.selectedProject.description}</span>\r\n                                </div>\r\n                                <div className=\"flex flex-col sm:flex-row ml-2\">\r\n                                    <button className=\"mb-2 sm:mr-2 sm:mb-0 px-3 py-1 rounded-md whitespace-no-wrap text-indigo-500 border select-none border-indigo-500 hover:bg-indigo-500 hover:text-gray-100\"\r\n                                            onClick={this.state.openProjectModal}>\r\n                                        <FontAwesomeIcon className=\"mr-2\" icon=\"pencil-alt\" />\r\n                                        Edit\r\n                                    </button>\r\n                                    <button className=\"px-3 py-1 rounded-md whitespace-no-wrap text-red-500 border select-none border-red-500 hover:bg-red-500 hover:text-gray-100\"\r\n                                            onClick={this.handleOnProjectDelete}>\r\n                                        <FontAwesomeIcon className=\"mr-2\" icon=\"times\" />\r\n                                        Delete\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"relative\">\r\n                                <button className=\"hide-proj px-2 pb-1 lg:px-3 lg:py-2 absolute rounded-b-full bg-gray-400 text-gray-900 hover:bg-gray-900 hover:text-gray-400\" onClick={this.handleHideTop}>\r\n                                    <FontAwesomeIcon className=\"sm:text-base lg:text-xl\" icon={this.state.topHidden ? 'chevron-down' : 'chevron-up'} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    { /* Working area where nodes are found */ }\r\n                    <ParentSize>\r\n                        {\r\n                            ({width, height}) => (\r\n                                <WorkArea projectId={this.props.projectId} width={width} height={height} />\r\n                            )\r\n                        }\r\n                    </ParentSize>\r\n                    {/* Modals below */}\r\n                    <Modal title=\"Edit Project\"\r\n                            openModal={callable => {\r\n                                if (!this.state.openProjectModal)\r\n                                    this.setState({openProjectModal: callable});\r\n                            }}>\r\n                        {({closeModal}) => (\r\n                        <ProjectForm title={this.state.selectedProject.title}\r\n                                        description={this.state.selectedProject.description}\r\n                                        handleOnProjectUpdate={this.handleOnProjectUpdate}\r\n                                        handleCloseModal={closeModal} />\r\n                        )}\r\n                    </Modal>\r\n                </div>\r\n            );\r\n\r\n        return(\r\n            <div className=\"p-6\">\r\n                <h1 className=\"text-xl font-bold\">\r\n                    Please select a project first.\r\n                </h1>\r\n            </div>\r\n        );\r\n    }\r\n}","import React from 'react';\nimport './assets/App.css';\n\nimport { library } from '@fortawesome/fontawesome-svg-core';\nimport { fas } from '@fortawesome/free-solid-svg-icons';\nimport { useParams, Switch, Route } from 'react-router-dom';\n\nimport SidebarNav from './components/SidebarNav.js';\nimport DBService from './services/DBService.js';\nimport Project from './components/Project';\n\nlibrary.add(fas);\n\nexport default class App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            projects: []\n        };\n\n        this.refreshProjects = this.refreshProjects.bind(this);\n        this.handleAddProject = this.handleAddProject.bind(this);\n    }\n\n  componentDidMount() {\n    this.refreshProjects();\n  }\n\n  refreshProjects() {\n    DBService.projects.toArray().then(projects => {\n      this.setState({ projects: projects });\n    });\n  }\n\n  handleAddProject(title, description) {\n    DBService.addProject(title, description)\n             .then(id => {\n                this.refreshProjects();\n             });\n  }\n\n  render() {\n    return (\n      <div className=\"flex flex-col lg:flex-row\">\n        <SidebarNav projects={this.state.projects} refreshProjects={this.refreshProjects} />\n        <article>\n          <Switch>\n            <Route path=\"/project/:projectId\">\n              <ParamsProvider>\n                {\n                  ({ projectId }) => {\n                    return <Project projectId={projectId} refreshProjects={this.refreshProjects} />\n                  }\n                }\n              </ParamsProvider>\n            </Route>\n            <Route path=\"/\">\n              <div className=\"p-6\">\n                <h1 className=\"text-xl font-bold\">\n                  Please select a project first.\n                </h1>\n              </div>\n            </Route>\n          </Switch>\n        </article>\n      </div>\n    );\n  }\n}\n\nfunction ParamsProvider({ children }) {\n  let { projectId } = useParams();\n  return children({ projectId });\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './assets/main.css';\nimport App from './App';\nimport Test from './Test';\nimport * as serviceWorker from './serviceWorker';\nimport { BrowserRouter } from 'react-router-dom';\n\nReactDOM.render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}